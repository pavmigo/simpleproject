import{Component as t}from"preact";function e(t){var e=t.client;this.getChildContext=function(){return{client:e}}}e.prototype.render=function(t){return t.children[0]};var n=function(t){function e(){t.call(this),this.state={loading:!1,loaded:!1,data:null}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentWillMount=function(){var t=this,e=this.props,n=e.query,r=e.variables,o=e.cacheKey,i=this.context.client;n&&i&&(this.setState({loading:!0}),i.query(n,r,o).then(function(e){t.setState({data:e,loading:!1,loaded:!0})})),o&&i&&i.listenTo(o,function(e){t.setState({data:e})})},e.prototype.render=function(t,e){return t.children[0](e)},e}(t),r=function(t){function e(){t.call(this),this.state={loading:!1,loaded:!1,data:null},this._mutate=this.mutate.bind(this)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.mutate=function(){var t=this,e=this.props,n=e.mutation,r=e.variables,o=e.updateCache,i=e.appendCache,a=this.context.client;n&&a&&(this.setState({loading:!0}),a.mutate(n,r,{updateCache:o,appendCache:i}).then(function(e){t.setState({data:e,loading:!1,loaded:!0})}))},e.prototype.render=function(t,e){return t.children[0](this._mutate,e)},e}(t),o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var i,a=Object.prototype.toString,c=function(t){var e;return"[object Object]"===a.call(t)&&(null===(e=Object.getPrototypeOf(t))||e===Object.getPrototypeOf({}))},u={default:c,__moduleExports:c},l=u&&c||u,s=(function(t){const e=Object.prototype.hasOwnProperty,n=Object.propertyIsEnumerable,r=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0}),i=o,a={concatArrays:!1},c=t=>{const r=[];for(const n in t)e.call(t,n)&&r.push(n);if(Object.getOwnPropertySymbols){const e=Object.getOwnPropertySymbols(t);for(let o=0;o<e.length;o++)n.call(t,e[o])&&r.push(e[o])}return r};function u(t){return Array.isArray(t)?function(t){const e=t.slice(0,0);return c(t).forEach(n=>{r(e,n,u(t[n]))}),e}(t):l(t)?function(t){const e=null===Object.getPrototypeOf(t)?Object.create(null):{};return c(t).forEach(n=>{r(e,n,u(t[n]))}),e}(t):t}const s=(t,e,n,o)=>(n.forEach(n=>{n in t&&t[n]!==Object.getPrototypeOf(t)?r(t,n,p(t[n],e[n],o)):r(t,n,u(e[n]))}),t),f=(t,n,o)=>{let i=t.slice(0,0),a=0;return[t,n].forEach(n=>{const l=[];for(let o=0;o<n.length;o++)e.call(n,o)&&(l.push(String(o)),r(i,a++,n===t?n[o]:u(n[o])));i=s(i,n,c(n).filter(t=>-1===l.indexOf(t)),o)}),i};function p(t,e,n){return n.concatArrays&&Array.isArray(t)&&Array.isArray(e)?f(t,e,n):l(e)&&l(t)?s(t,e,c(e),n):u(e)}t.exports=function(){const t=p(u(a),this!==i&&this||{},a);let e={foobar:{}};for(let n=0;n<arguments.length;n++){const r=arguments[n];if(void 0!==r){if(!l(r))throw new TypeError("`"+r+"` is not an Option Object");e=p(e,{foobar:r},t)}}return e.foobar}}(i={exports:{}},i.exports),i.exports);function f(t){var e=t.url,n={},r={},o=function(t){r[t]&&r[t].forEach(function(e){return e(n[t])})},i=function(t){return function(e){if(!t)return e;var r=s(n[t]||{},e);return n[t]=r,o(t),r}};return{query:function(t,r,o){void 0===r&&(r={});var a,c=(a=o)?n[a]:null;if(c)return Promise.resolve(c);var u=JSON.stringify({query:t,variables:r});return fetch(e,{body:u,headers:{"Content-Type":"application/json"},method:"POST"}).then(function(t){return t.json()}).then(function(t){return t.data}).then(i(o))},mutate:function(t,r,a){void 0===r&&(r={});var c,u=a.updateCache,l=a.appendCache,s=JSON.stringify({query:t,variables:r});return fetch(e,{body:s,headers:{"Content-Type":"application/json"},method:"POST"}).then(function(t){return t.json()}).then(function(t){return t.data}).then(u?i(u):function(t){return t}).then(l?(c=l,function(t){return c?(Object.keys(t).forEach(function(e){n[c][e]||(n[c][e]=[]),n[c][e].push(t[e])}),o(c),t):t}):function(t){return t})},listenTo:function(t,e){r[t]||(r[t]=[]),r[t].push(e)},clearCache:function(){Object.keys(r).forEach(function(t){n[t]=null,delete n[t],o(t)})}}}export{e as Provider,n as Query,r as Mutation,f as Client};
//# sourceMappingURL=praphql.es.js.map
